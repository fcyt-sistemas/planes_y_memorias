ALTER TABLE PUBLIC.CARRERAS3 ADD ID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1, INCREMENT BY 1) PRIMARY KEY;
ALTER TABLE PUBLIC.MATERIAS3 ADD ID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1, INCREMENT BY 1) PRIMARY KEY;
ALTER TABLE PUBLIC.PLANES3 ADD ID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1, INCREMENT BY 1) PRIMARY KEY;
ALTER TABLE PUBLIC.SEDES ADD ID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1, INCREMENT BY 1) PRIMARY KEY;


//PLAN MATERIAS
//OJO...SE DEBE SACAR LUEGO DE QUE SE HAN INDEXADO DESDE 1 LAS TABLAS DE MATERIAS Y PLANES
SELECT DISTINCT 
	P.ID AS "plan_id", M.ID AS "catedra_id"
FROM 
	MATERIA_PLAN_3 MP, MATERIAS3 M, PLANES3 P
WHERE 
	MP.MATERIA = M.MATERIA
AND MP.PLAN = P.PLAN
AND MP.CARRERA = P.CARRERA
;

//PLANES TOOLS
SELECT p.UNIDAD_ACADEMICA, CARRERA, p.PLAN, p.NRO_RESOLUCION, p.CNT_MATERIAS, p.ESTADO
FROM
PLANES1 p
UNION
SELECT p2.UNIDAD_ACADEMICA,CARRERA, p2.PLAN, p2.NRO_RESOLUCION, p2.CNT_MATERIAS, p2.ESTADO
FROM
PLANES2 p2 
ORDER BY 1
;

//planes exportar
SELECT p.id, p.UNIDAD_ACADEMICA, c.id AS CARRERA_id, p.PLAN, p.NRO_RESOLUCION, p.CNT_MATERIAS, p.ESTADO
FROM
PLANES3 p LEFT JOIN CARRERAS3 c ON p.CARRERA = c.CARRERA
;

//TOOLS MATERIAS
SELECT *
FROM MATERIAS m
UNION
SELECT *
FROM MATERIAS_URU m
ORDER BY 1
;

//MATERIAS EXPORTAR
SELECT ID, UNIDAD_ACADEMICA, MATERIA, NOMBRE, TIPO_DE_MATERIA, PROMOVIBLE, REQUIERE_CURSADA, PERMITE_LIBRES, CARGA_HORARIA_TOT, TIPO_DE_PERIODO, HORAS_SEMANALES
FROM PUBLIC.MATERIAS3
;


//tools para carreras
SELECT UNIDAD_ACADEMICA, CARRERA, NOMBRE, PLAN_VIGENTE, TIPO_DE_CARRERA, NRO_RESOLUCION
FROM
CARRERAS
UNION
SELECT UNIDAD_ACADEMICA, CARRERA, NOMBRE, PLAN_VIGENTE, TIPO_DE_CARRERA, NRO_RESOLUCION
FROM
CARRERAS2
ORDER BY 1
;

//carreras exportar
SELECT id, UNIDAD_ACADEMICA, CARRERA, NOMBRE, PLAN_VIGENTE, TIPO_DE_CARRERA, NRO_RESOLUCION
FROM
CARRERAS3
ORDER BY 1
;


//tools MP
SELECT *
FROM MATERIA_PLAN m
UNION
SELECT *
FROM MATERIA_PLAN_URU m
ORDER BY 1
;

//PLAN MATERIAS
//OJO...SE DEBE SACAR LUEGO DE QUE SE HAN INDEXADO DESDE 1 LAS TABLAS DE MATERIAS Y PLANES
SELECT DISTINCT 
	P.ID AS "plan_id", M.ID AS "catedra_id"
FROM 
	MATERIA_PLAN_3 MP, MATERIAS3 M, PLANES3 P
WHERE 
	MP.MATERIA = M.MATERIA
AND MP.PLAN = P.PLAN
AND P.CARRERA = MP.CARRERA
;

//sedes tools
SELECT id,'FCYT' AS "unidad_academica", SEDE AS "codigo", NOMBRE AS "nombre", DIRECCION AS "direccion", LOCALIDAD AS "localidad", 'null' AS "codigo_postal",'null' AS "telefono",'null' AS "email"
FROM PUBLIC.SEDES
;

//carreras_sedes
SELECT DISTINCT
	c.id AS "carrera_id", s.id AS "sede_id"
FROM 
	CARRERAS3 c, SEDES s, CARRERAS_SEDE cs
WHERE
	cs.CARRERA = c.CARRERA
AND cs.SEDE = s.SEDE
ORDER BY 1
;


